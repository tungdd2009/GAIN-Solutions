<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Lesson Architect ‚Äì Teaching Tool</title>

<style>
/* === VARIABLES === */
:root {
    --primary: #1a73e8;
    --secondary: #34a853;
    --accent: #fbbc05;
    --bg: #f4f7fb;
    --surface: #ffffff;
    --border: #dde3ea;
    --text: #202124;
    --muted: #5f6368;
}

/* === RESET === */
* { box-sizing: border-box; }

/* === BASE === */
body {
    margin: 0;
    font-family: 'Segoe UI', Roboto, Helvetica, sans-serif;
    background: linear-gradient(180deg, #eef3fc, var(--bg));
    padding: 24px;
    display: flex;
    justify-content: center;
}

/* === APP === */
.app {
    max-width: 980px;
    width: 100%;
    background: var(--surface);
    border-radius: 18px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    overflow: hidden;
}

/* === HEADER === */
.app-header {
    padding: 28px 36px;
    background: linear-gradient(135deg, var(--primary), #4285f4);
    color: white;
    display: flex;
    align-items: center;
    gap: 16px;
}

.app-header img {
    width: 42px;
    height: 42px;
    background: white;
    border-radius: 10px;
    padding: 6px;
}

.content {
    padding: 36px;
}

/* === SECTIONS === */
.section {
    margin-bottom: 36px;
    border-left: 4px solid var(--primary);
    padding-left: 20px;
}

.section.context {
    border-color: var(--secondary);
}

/* === FORM === */
.row {
    display: flex;
    gap: 20px;
    margin-bottom: 18px;
}

.col { flex: 1; }

label {
    font-size: 13px;
    font-weight: 600;
    display: block;
    margin-bottom: 6px;
}

input, select, textarea {
    width: 100%;
    padding: 11px;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: #fbfcff;
}

small { color: var(--muted); }

/* === BUTTON === */
button {
    width: 100%;
    padding: 16px;
    font-size: 16px;
    font-weight: 600;
    background: linear-gradient(135deg, var(--primary), #4285f4);
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
}

button:disabled {
    background: #c7c7c7;
    cursor: not-allowed;
}

/* === STATUS === */
#status {
    display: none;
    margin-top: 18px;
    padding: 18px;
    border-radius: 14px;
    background: #f1f8ff;
    border: 1px solid #d2e3fc;
}
</style>
</head>

<body>

<div class="app">
    <div class="app-header">
        <img src="logo.png" alt="Logo">
        <div>
            <h1>AI Lesson Architect</h1>
            <p>Tr·ª£ l√Ω AI gi√∫p gi√°o vi√™n so·∫°n b√†i nhanh & ch√≠nh x√°c</p>
        </div>
    </div>

    <div class="content">

        <div class="section">
            <h2>1. Th√¥ng tin b√†i h·ªçc</h2>

            <div class="row">
                <div class="col">
                    <label>Ch·ªß ƒë·ªÅ b√†i h·ªçc</label>
                    <input id="topic" placeholder="V√≠ d·ª•: Quang h·ª£p ·ªü th·ª±c v·∫≠t">
                </div>
                <div class="col">
                    <label>C·∫•p h·ªçc</label>
                    <select id="grade">
                        <option>Ti·ªÉu h·ªçc (K-5)</option>
                        <option>THCS (6-8)</option>
                        <option>THPT (9-12)</option>
                        <option>ƒê·∫°i h·ªçc</option>
                    </select>
                </div>
            </div>

            <label>S·ªë l∆∞·ª£ng slide: <strong><span id="slideValue">5</span></strong></label>
            <input type="range" id="slideCount" min="3" max="16" value="5">
            <small>G·ª£i √Ω: 5‚Äì7 slide cho 45 ph√∫t</small>
        </div>

        <div class="section context">
            <h2>2. B·ªëi c·∫£nh gi·∫£ng d·∫°y</h2>

            <div class="row">
                <div class="col">
                    <label>Ph∆∞∆°ng ph√°p</label>
                    <select id="method">
                        <option>Gi·∫£ng d·∫°y truy·ªÅn th·ªëng</option>
                        <option>STEAM / D·ª± √°n</option>
                        <option>T∆∞∆°ng t√°c</option>
                    </select>
                </div>
                <div class="col">
                    <label>Ghi ch√∫</label>
                    <textarea id="extraContext"></textarea>
                </div>
            </div>
        </div>

        <button id="generate" disabled>üöÄ T·∫°o b√†i gi·∫£ng b·∫±ng AI</button>
        <div id="status"></div>

    </div>
</div>

<script>
const slide = document.getElementById("slideCount");
const slideValue = document.getElementById("slideValue");
const topic = document.getElementById("topic");
const btn = document.getElementById("generate");
const status = document.getElementById("status");

slide.oninput = () => slideValue.textContent = slide.value;
topic.oninput = () => btn.disabled = !topic.value.trim();

btn.onclick = async () => {
    btn.disabled = true;
    status.style.display = "block";
    status.textContent = "ƒêang t·∫°o b√†i gi·∫£ng...";

    try {
        const res = await fetch("/api/generate", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                topic: topic.value,
                grade: document.getElementById("grade").value,
                slideCount: Number(slide.value),
                age: 30,
                region: "VN",
                method: document.getElementById("method").value,
                theories: ["Bloom"],
                extraContext: document.getElementById("extraContext").value,
                language: "VN"
            })
        });

        const data = await res.json();
        if (!data.success) throw new Error(data.error);

        const blob = new Blob(
            [Uint8Array.from(atob(data.file), c => c.charCodeAt(0))],
            { type: "application/vnd.openxmlformats-officedocument.presentationml.presentation" }
        );

        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "lesson.pptx";
        a.click();

        status.textContent = "Ho√†n t·∫•t! File ƒëang t·∫£i v·ªÅ.";
    } catch (e) {
        status.textContent = "L·ªói: " + e.message;
    } finally {
        btn.disabled = false;
    }
};
</script>

</body>
</html>
